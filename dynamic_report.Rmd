---
title: My dynamic report
output: html_fragment
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, error=FALSE)

```

```{css}
  body {
    color: #4a4949;
    background-color: #f9f9f9;
    font-family: "KG Perfect Penmanship";
  }

```
# Project 2 Youtube ads
### Seulgi Lim / Slim674

Over several days we collected data based on the ads we received on Youtube. We collected data asking if the ad was skippable or not skippable, if it was previously seen or new, and the length of the ad. The data was collected on Google Form and was analysed further.

## Summary values
### From our sample, what is the mean length of the ads how does that compare with the longest ad?

```{r}
# Installing Tidyverse
library(tidyverse)

# Data
cvs_file <- "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ2Y3NqqIrURCjuTCuH4imN6OJmCdzT0UP4_gwux7oOx43LrwrpS5gVCayY-pShcMSNi9nns6XspPXW/pub?gid=296879182&single=true&output=csv"
logged_data <- read_csv(cvs_file)

latest_data <- logged_data %>% 
  rename(Date_and_Time = 1, 
         Ad_length = 2,
         Ad_type = 3,
         New_or_old_ad = 4)

# What is the longest ad?
longest_ad <- max(latest_data$Ad_length) # longest_ad <- max(latest_data$Ad_length)

# What is the mean ad length?
mean_ad <- mean(latest_data$Ad_length) %>% round(2) # mean_ad <- mean(latest_data$Ad_length) %>% round(2)

paste("The longest ad is", 
      longest_ad, 
      "sec.", 
      "The mean ad length is",
      mean_ad,
      "sec.")
```
## Graphs
### How often are the ads updated? Do we really see the same ads?
This was asked to see if they update their ad library. It was also asked to see how heavily they were influenced by age, demographic, or gender. 
```{r}
BG1 <- ggplot(data = latest_data) +
  geom_bar(aes(x = New_or_old_ad),
           fill = "#ADD8E6") +
  labs(title = "Are the same ads shown repeatedly?",
       subtitle = "Bar chart showing if the same ads were shown or new ads in sample(Stats220P2)",
       caption = "Source: Youtube",
       x = "New or old ad",
       y = "Percentage")

ggsave(bargraph1.png, plot = BG1)
```

However, we saw that most of the ads were new. This suggests that they do not heavily personalise who they show their ads to. This also confirms that the ads are not as repetitive as we believe.  

### What type of ad is most common for what length of ad?

This question was ask to identify any relationship between Ad Length and Ad type 

```{r}
BG2 <- latest_data %>%
  ggplot() +
  geom_bar(aes(x = Ad_length, fill = Ad_type)) +
  labs(title = "Relationship between Ad length and Ad type",
       subtitle = "Comparing Ad length and Ad type for ads on the (Stats220P2)",
       caption = "Source: Youtube",
       x = "Ad length (sec)",
       y = "Ad type")

ggsave(bargraph2.png, plot = BG2)
```

The bar graph above shows that as the ad is shorter than 15 seconds, it tends to be not skippable. However, if it is longer than 15s, they are skippable. If the ad was precisely 15sec, the ad was evenly likely to be skippable or not. After further research, we figured out YouTube's rule highly influenced the pattern we observed; the maximum length for a non-skippable ad was 15 sec. 

## Overall 
From the data I have collected, I have analysed that the ads are not as long and repetitive as I thought. Youtube displays a large variety of ads.

```{r}
library(magick)
counts <- 1 : 4

meme <- image_read(url)
  
frame1 <- 

frame2 <- meme %>%
  image_annotate(text = "I CAN HAS CHEEZEBURGER?",
                 size = 40, 
                 font = "Impact",
                 color = "#f5f107",
                 gravity = "north")

frame3 <- meme %>%
  image_annotate(text = "I CAN HAS CHEEZEBURGER?",
                 size = 40, 
                 font = "Impact",
                 color = "#1ff507",
                 gravity = "center")

frame4 <- meme %>%
  image_annotate(text = "I CAN HAS CHEEZEBURGER?",
                 size = 40, 
                 font = "Impact",
                 color = "#07d9f5",
                 gravity = "north")


my_animated_meme <- frames <- c(frame1, frame2, frame3, frame4)

image_animate(frames, fps = 1)
```
